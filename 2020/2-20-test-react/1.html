<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
    <script src="../../my-min-library/react.min.js"></script>
    <script src="../../my-min-library/reactdom.min.js"></script>
    <script src="../../my-min-library/babel.min.js"></script>
  </head>
  <body>
    <div id="app"></div>
    <script type="text/babel">
      const a = Array.from({ length: 40 }).map((x, i) => "a" + i);
      const b = Array.from({ length: 40 }).map((x, i) => "b" + i);
      console.log(a);

      const { Component } = React;
      const reRender = () => {
        ReactDOM.render(<M data={b} />, app);
      };
      const x = {
        switch: true
      };
      class M extends Component {
        reset(i) {
          if (i === undefined) return;
          this.props.data.splice(i, 1);

          if (x.switch) {
            x.switch = false;
            this.setState({});
          }
        }
        render() {
          console.log(a);
          if (x.switch) {
            this.reset();
          }
          const { data } = this.props;
          return (
            <ul>
              {data.map((val, i) => {
                return (
                  <li key={"he"}>
                    {
                      <N
                        val={val}
                        which={i + ""}
                        tell={this.reset.bind(this)}
                      />
                    }{" "}
                  </li>
                );
              })}
            </ul>
          );
        }
      }
      class N extends Component {
        render() {
          const { val, tell, which } = this.props;
          return (
            <p>
              {val}
              <span
                onClick={() => {
                  x.switch = true;
                  tell(which);
                  // this.setState({})
                }}
              >
                del
              </span>
            </p>
          );
        }
      }
      ReactDOM.render(<M data={a} />, app);
      setTimeout(() => {
        reRender();
      }, 1000);
    </script>
  </body>
</html>
